UWAGA - KOD NIE PELNY!

<style>
/* Zmiana koloru tła dla dni roboczych */
.fc-daygrid-day {
    background-color: #f8f9fa;
}

/* Zmiana wyglądu przycisków */
.fc .fc-button {
    font-size: 0.875rem;
    font-weight: 500;
}

/* Nadanie przyciskom stylu Bootstrapa */
.fc .fc-button-primary {
    background-color: var(--bs-primary) !important;
    border-color: var(--bs-primary) !important;
}

.fc .fc-button-primary:hover {
    background-color: var(--bs-primary-dark);
}

/* Dostosowanie wyglądu wydarzeń */
.fc-event {
    background-color: var(--bs-success) !important;
    border-color: var(--bs-success) !important;
    color: white;
    padding: 5px;
    border-radius: 5px;
}

/* Zaokrąglone rogi dla kart wydarzeń */
.fc-daygrid-event {
    border-radius: 8px;
}

/* Styl dla aktywnego dnia */
.fc-day-today {
    background-color: var(--bs-success-20) !important;
}

.fc .fc-toolbar-title {
    font-size: 1.75em !important;
    margin: 0px;
}
</style>

<div class="card">
      <div class="card-header d-flex flex-wrap align-items-center justify-content-between gap-3">
        <div class="d-flex flex-wrap align-items-center gap-3">
        </div>
        <div class="d-flex flex-wrap align-items-center gap-3">
           <a href="{% url 'dodaj_zadanie_uzytkownika' %}" class="btn btn-primary">Dodaj Zadanie</a>
</div>
      </div>
      <div class="card-body">

    <div id="calendar"></div>

        <div class="row mt-50">
            <div class="col-md-6 border-end">
                <h5 class="card-title">Kolumna 1</h5>
            {% regroup zadania by termin_wykonania as zadania_pogrupowane %}
            {% for grupa in zadania_pogrupowane %}
                <h4>
                {% if grupa.grouper == today %}
                    Dzisiaj
                    {% elif grupa.grouper == tomorrow %}
                    Jutro
                    {% else %}
                     {{ grupa.grouper|date:"l, d E Y" }}
                {% endif %}
                </h4>
                <ul>
                {% for zadanie in grupa.list %}
                    <li>
                        <span style="color: green;">•</span>
                        {{ zadanie.tytul }} - Termin: {{ zadanie.termin_wykonania|date:"Y-m-d" }}
                         <a href="{% url 'edytuj_zadanie_uzytkownika' pk=zadanie.pk %}">Edytuj</a>
                        <form method="post" action="{% url 'usun_zadanie_uzytkownika' pk=zadanie.pk %}" style="display: inline;">
                            {% csrf_token %}
                            <button type="submit" class="btn btn-sm btn-outline-danger" onclick="return confirm('Czy na pewno chcesz usunąć to zadanie?')">Usuń</button>
                        </form>
                         {% if not zadanie.wykonane %}
                            <form method="post" action="{% url 'oznacz_zadanie_uzytkownika' pk=zadanie.pk %}">
                                {% csrf_token %}
                                <button type="submit" class = "btn btn-sm btn-info">Oznacz jako wykonane</button>
                            </form>
                        {% endif %}

                         {% if zadanie.faktura %}
                            <p>Powiązana faktura: <a href="{% url 'szczegoly_faktury' pk=zadanie.faktura.pk %}">{{ zadanie.faktura.numer }}</a></p>
                        {% endif %}

                    </li>
                {% empty %}
                    <li>Brak zadań.</li>
                {% endfor %}
                </ul>
            {% empty %}
            <p>Brak zadań.</p>
            {% endfor %}
            </div>
            <div class="col-md-6">
                <h5 class="card-title">Płatności</h5>
                <ul>
                {% for faktura in upcoming_invoices %}  
                    <li>
                        {% if faktura.typ_faktury == 'sprzedaz' %}
                           <span style ="color: blue">•</span>
                        {% else %}
                            <span style ="color: red">•</span>
                        {% endif %}
                        Faktura {{ faktura.numer }} - Termin płatności: {{ faktura.termin_platnosci|date:"Y-m-d" }}
                        <a href="{% url 'szczegoly_faktury' pk=faktura.pk %}">Szczegóły</a>
                        {% if faktura.termin_platnosci < today %}  <-- Sprawdzamy, czy przeterminowana
                            <a href="{% url 'wyslij_przypomnienie' pk=faktura.pk %}" class="btn btn-sm btn-warning">Wyślij przypomnienie</a>
                        {% endif %}
                    </li>
                {% endfor %}
                 {% for faktura in overdue_invoices %} 
                    <li>
                         {% if faktura.typ_faktury == 'sprzedaz' %}
                           <span style ="color: blue">•</span>
                        {% else %}
                            <span style ="color: red">•</span>
                        {% endif %}
                        Faktura {{ faktura.numer }} - Termin płatności: {{ faktura.termin_platnosci|date:"Y-m-d" }}
                        <a href="{% url 'szczegoly_faktury' pk=faktura.pk %}">Szczegóły</a>
                        {% if faktura.termin_platnosci < today %}
                            <a href="{% url 'wyslij_przypomnienie' pk=faktura.pk %}" class = "btn btn-warning btn-sm">Wyślij przypomnienie</a>
                        {% endif %}
                    </li>
                {% empty %}
                    <li>Brak faktur.</li>
                {% endfor %}

            </div>
        </div>

</div>

    {% block extra_js %}

    <link href='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/main.min.css' rel='stylesheet' />
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.js'></script>
<script src="https://cdn.jsdelivr.net/npm/@fullcalendar/bootstrap5/main.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@fullcalendar/core/locales/pl.js"></script>
    
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        var calendarEl = document.getElementById('calendar');
    
        var calendar = new FullCalendar.Calendar(calendarEl, {
themeSystem: 'bootstrap5',  // Ustawienie motywu Bootstrap 5
          initialView: 'dayGridMonth',
          locale: 'pl',  // Ustaw język polski
          events: '{% url "get_events" %}', // URL do widoku zwracającego dane
          // Możesz dodać więcej opcji konfiguracji, np.
          headerToolbar: {
            left: 'prev,next today',
            center: 'title',
            right: 'dayGridMonth,timeGridWeek,timeGridDay'
          },
        });
    
        calendar.render();
      });
    </script>
    {% endblock %}